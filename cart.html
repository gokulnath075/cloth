<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Shopping Cart — PREMIUM.</title>
  <link rel="stylesheet"
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200">
  <link rel="stylesheet" href="styles.css">
</head>

<body>
  <div id="navbar"></div>
  <div class="cart-page">
    <div class="container">
      <div class="breadcrumb"><a href="index.html">Home</a><span class="sep">/</span><span class="current">Shopping
          Cart</span></div>
      <h1 style="font-size:2rem;margin-bottom:32px">Shopping Cart</h1>
      <div id="cartContent"></div>
    </div>
  </div>
  <div id="footer"></div>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <script src="firebase-config.js"></script>
  <script src="data.js"></script>
  <script src="app.js"></script>
  <script>
    document.getElementById('navbar').innerHTML = getNavbarHTML();
    document.getElementById('footer').innerHTML = getFooterHTML();
    initApp();

    function renderCart() {
      const cart = Store.getCart();
      if (cart.length === 0) {
        document.getElementById('cartContent').innerHTML = `<div class="empty-state"><span class="material-symbols-outlined" style="font-size:4rem;color:var(--grey-300);margin-bottom:16px">shopping_bag</span><h2>Your cart is empty</h2><p>Looks like you haven't added anything yet.</p><a href="category.html" class="btn btn-primary">Start Shopping</a></div>`;
        return;
      }
      const subtotal = Store.getCartTotal();
      const shipping = subtotal >= 1999 ? 0 : 149;
      const total = subtotal + shipping;
      document.getElementById('cartContent').innerHTML = `
        <div class="cart-layout">
          <div class="cart-items">
            ${cart.map((item, idx) => {
        const p = getProduct(item.productId);
        if (!p) return '';
        return `<div class="cart-item">
                <a href="product.html?id=${p.id}"><img src="${p.image}" alt="${p.name}"></a>
                <div class="cart-item-info">
                  <h3><a href="product.html?id=${p.id}">${p.name}</a></h3>
                  <div class="meta">Size: ${item.size} · ${p.fabric}</div>
                  <div class="price">${formatPrice(p.price)}</div>
                </div>
                <div class="cart-item-actions">
                  <div class="qty-control">
                    <button onclick="updateQty(${idx}, ${item.qty - 1})">−</button>
                    <span>${item.qty}</span>
                    <button onclick="updateQty(${idx}, ${item.qty + 1})">+</button>
                  </div>
                  <div style="font-weight:700;font-size:1.1rem">${formatPrice(p.price * item.qty)}</div>
                  <button class="remove-btn" onclick="removeItem(${idx})"><span class="material-symbols-outlined" style="font-size:1rem">delete</span> Remove</button>
                </div>
              </div>`;
      }).join('')}
          </div>
          <div class="cart-summary">
            <h3>Order Summary</h3>
            <div class="summary-row"><span>Subtotal (${cart.reduce((s, i) => s + i.qty, 0)} items)</span><span>${formatPrice(subtotal)}</span></div>
            <div class="summary-row"><span>Shipping</span><span>${shipping === 0 ? '<span style="color:var(--success)">FREE</span>' : formatPrice(shipping)}</span></div>
            ${shipping > 0 ? `<div style="font-size:.75rem;color:var(--gold-dark);margin-bottom:8px">Add ₹${(1999 - subtotal).toLocaleString('en-IN')} more for free shipping</div>` : ''}
            <div class="coupon-input"><input type="text" placeholder="Coupon code"><button class="btn btn-sm btn-secondary" onclick="showToast('Coupon applied!','success')">Apply</button></div>
            <div class="summary-row total"><span>Total</span><span>${formatPrice(total)}</span></div>
            <a href="checkout.html" class="btn btn-primary" style="width:100%;margin-top:20px">Proceed to Checkout</a>
            <a href="category.html" style="display:block;text-align:center;margin-top:12px;font-size:.85rem;color:var(--gold-dark)">Continue Shopping</a>
          </div>
        </div>`;
    }

    function updateQty(idx, qty) { Store.updateCartQty(idx, qty); renderCart(); }
    function removeItem(idx) { Store.removeFromCart(idx); showToast('Item removed'); renderCart(); }

    renderCart();
    window.addEventListener('cartUpdated', renderCart);
  </script>
</body>

</html>